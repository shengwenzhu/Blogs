# CAP 理论

CAP 定理：对于一个分布式系统，当涉及读写操作时，只能同时满足以下三点中的两点

- Consistency（一致性）：“all nodes see the same data at the same time”，即对某个节点的数据更新后，进行读操作时无论从哪个节点读取都能够返回写操作的值；
- Availability（可用性）：“reads and writes always succeed”，即用户访问数据时，系统能在正常响应时间内返回结果（不出现用户操作失败或者访问超时）
- Partition Tolerance（分区容错性）：系统在遇到某节点或网络分区故障时，仍能提供正常服务；

> 注：在分布式的环境下，网络无法做到100%可靠，有可能出现故障，所以分区容错性是一个必须的选择，所以 **只能选择 CP 或者 AP 架构** ；



# BASE 理论

BASE 理论是对 CAP 的延伸和补充，是对 CAP 理论中一致性（C）和可用性（A）进行权衡的结果；

+ Basically Available（基本可用）：系统出现故障时，允许损失部分可用性；
+ Soft-state（软状态）：允许不同节点的副本之间存在暂时的不一致情况；
+ Eventually Consistent（最终一致性）：要求系统中数据副本最终能够一致，而不需要实时保证数据副本一致



# 服务注册中心

服务注册中心解决的两个问题：

+ 服务注册：服务器将自身服务信息注册到注册中心；

  > 服务信息：提供服务的主机 IP 和端口 Port，服务的自身状态，访问协议信息

+ 服务发现：客户端通过注册中心获取服务信息，通过服务信息去请求服务；

## EUREKA

+ 保证 AP，即可用性和分区容错性；

+ 每一个节点都是平等的，一部分节点挂掉不会影响到正常节点的工作，客户端发现向某个节点注册或连接失败，会自动切换到其他的节点；

+ 数据不一致性带来的问题：

  + 某一个节点被注册的服务多，某个节点注册的服务少；在某一个瞬间可能导致某些ip节点被调用数少，某些ip节点调用数少；

  

## ZooKeeper

+ 保证CP，即一致性和分区容错性；
+ 在使用zookeeper获取服务列表时，如果zk正在选举或者zk集群中半数以上的机器不可用，那么将无法获取数据；





# 一、高并发

如何实现服务器端与多个客户端的通信？

## 1.1 多线程

对于每个客户端的请求，创建一个线程去处理请求；

## 1.2 IO 多路复用