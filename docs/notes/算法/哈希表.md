##  哈希表

### 3.1.1 作用

**直接确定某条记录在一个数据结构中的位置**。

在线性表、树等各种结构中，记录的位置是随机的，在这些结构中查找记录需要经过一系列的比较，这一类查找建立在“比较”的基础上，查找的效率依赖于查找过程中所进行的比较次数；理想的情况是不经过任何比较就能得到记录的位置，这就需要在记录的存储位置和记录关键字之间建立一个对应关系f，使得每个关键字和唯一的存储位置相对应，这样查找时根据对应关系f就可以确定记录的位置，这个对应关系就是**哈希函数**；

### 3.1.2 哈希函数

#### 1）直接定址法

取关键字或关键字的某个线性函数值为哈希地址；即`H(key) = key`或 `H(key) = a*key + b`，其中a和b为常数；

实际使用情况很少；

#### 2）数字分析法

当哈希表中的关键字都是事先知道的，可取关键字的若干分布较均匀的数位组成哈希地址；

比如一组员工的出生年月日，出生年月日的前几位数字大体相同，出现冲突的几率就会很大，但是年月日的后几位表示月份和具体日期的数字差别很大，如果用后面的数字来构成散列地址，则冲突的几率会明显降低。因此数字分析法就是**找出数字的规律，尽可能利用这些数据来构造冲突几率较低的哈希地址**。

#### 3)    平方取中法

当**无法确定关键字中哪几位分布较均匀**时，可以先求出关键字的平方值，然后按需要取平方值的中间几位作为哈希地址。这是因为：平方后中间几位和关键字中每一位都相关，故不同关键字会以较高的概率产生不同的哈希地址。取得位数由表长决定。

较常用的构造哈希函数的方法；

#### 4)    折叠法

将关键字分割成位数相同的几部分，最后一部分位数可以不同，然后取这几部分的叠加和（去除进位）作为散列地址。数位叠加可以有移位叠加和间界叠加两种方法。移位叠加是将分割后的每一部分的最低位对齐，然后相加；间界叠加是从一端向另一端沿分割界来回折叠，然后对齐相加。

使用情况：关键字位数很多，而且关键字中每一位上的数字分布大致均匀时；

#### 5)    除留余数法（使用较多）

取关键字被某个不大于散列表表长m的数p除后所得的余数为散列地址。即 `H(key) = key MOD p, p<=m`。

不仅可以对关键字直接取模，也可在折叠、平方取中等运算之后取模。

对 **p** 的选择很重要，若p选的不好，容易产生冲突；

由众人的经验得知，一般取质数或 不包含小于20的质因数的合数 （严蔚敏 数据结构）；

**最常用的构造哈希函数的方法**；

#### 6)    随机数法

选择一随机函数，取关键字的随机值作为散列地址，即H(key)=random(key)其中random为随机函数,通常用于**关键字长度不等**的场合。

实际工作中需要根据不同的情况采用不同的哈希函数；需要考虑的因素如下：

+ 计算哈希函数所需时间

+ 关键字的长度
+ 哈希表的大小
+ 关键字的分布情况
+ 记录的查找频率

### 3.1.3 处理冲突的方法

对不同的记录可能得到同一哈希地址，即`key1 != key2`，而`f(key1) = f(key2)`，这种现象称为**冲突**；

冲突只能尽可能少，但不能完全避免；

当发生冲突时，通常用的方法如下：

#### 1) 开放定址法

$$
H_i=( H(key)+ d_i  )MOD m，i=1，2，…，k(k<=m-1），其中H(key) 为哈希函数，m为哈希表表长，d_i为增量序列
$$

增量序列有3种取法：

+ 线性探测再散列：
  $$
  d_i= 1,2,3,...,m-1
  $$

+ 二次探测再散列：
  $$
  d_i= 1^2,-1^2,2^2,-2^2,...,±k^2 (k<=m/2)
  $$

+ 伪随机探测再散列：
  $$
  d_i= 伪随机数序列
  $$

#### 2) 再散列法      

$$
H_i=RH_i (key)
$$

RHi是不同的哈希函数，即对于某一条记录，计算其哈希地址后如果产生地址冲突则使用另一个哈希函数计算，直到冲突不再发生，这种方法**不易产生“聚集”**，但增加了计算时间。

#### 3) 链地址法

将哈希地址相同的记录存储在一个线性链表中。

<img src="../../../../旧笔记/算法与数据结构/image/哈希表链地址法.PNG" style="zoom:30%;" />

#### 4)    建立一个公共溢出区

### 3.1.4 哈希表查找性能

在哈希表上查找的过程和哈希造表的过程基本一致。

虽然哈希表在关键字与记录的存储位置之间建立了直接映射，但是由于冲突的存在，使得哈希表的查找过程仍然是一个给定值和关键字进行比较的过程。因此，仍需要<span style='color:red;background:背景颜色;font-size:文字大小;font-family:字体;'>**以平均查找长度作为衡量哈希表的查找效率的衡量尺度**</span>。

查找过程中需要比较的次数取决于三个因素：

+ 哈希函数是否均匀（影响出现冲突的频繁程度）

+ 处理冲突的方法

+ 哈希表的装填因子
  $$
  α= 填入表中的元素个数 / 散列表的长度
  $$

对于均匀的哈希函数，就不考虑它对平均查找长度的影响，使用不同的处理冲突的方法需要的平均查找长度如下所示：

<img src="../../../../旧笔记/算法与数据结构/image/平均查找长度.PNG" style="zoom:80%;" />

哈希表的平均查找长度是装填因子α的函数，只是不同处理冲突的方法有不同的函数。

**通常情况下，认为α=0.75**是时间空间综合利用效率最高的情况。

### 3.1.5 构建哈希表

![构建哈希表过程](../../../../旧笔记/算法与数据结构/image/构建哈希表过程.PNG)

### 3.1.6 哈希表删除元素

使用链地址法处理冲突的哈希表是可以直接删除元素的，**在非链地址处理冲突的哈希表中删除一条记录，需要在该记录的位置上填入一个特殊的符号，以免找不到它之后填入的“同义词”的记录**；

------

